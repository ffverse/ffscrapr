<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ESPN: Get Endpoint • ffscrapr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="ESPN: Get Endpoint">
<meta property="og:description" content="ffscrapr">
<meta property="og:image" content="ffscrapr.dynastyprocess.com/reference/figures/ffscrapr.svg">
<meta property="og:image:alt" content="ffscrapr - an R client for fantasy football platforms">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@_TanHo">
<meta name="twitter:site" content="@DynastyProcess">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ffscrapr</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">1.4.2.03</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    <li class="dropdown-header">Getting Started</li>
    <li>
      <a href="../articles/mfl_basics.html">MFL: Basics</a>
    </li>
    <li>
      <a href="../articles/sleeper_basics.html">Sleeper: Basics</a>
    </li>
    <li>
      <a href="../articles/fleaflicker_basics.html">Fleaflicker: Basics</a>
    </li>
    <li>
      <a href="../articles/espn_basics.html">ESPN: Basics</a>
    </li>
    <li>
      <a href="../articles/espn_authentication.html">ESPN: Private Leagues</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Custom API Calls</li>
    <li>
      <a href="../articles/mfl_getendpoint.html">MFL: Get Endpoint</a>
    </li>
    <li>
      <a href="../articles/sleeper_getendpoint.html">Sleeper: Get Endpoint</a>
    </li>
    <li>
      <a href="../articles/fleaflicker_getendpoint.html">Fleaflicker: Get Endpoint</a>
    </li>
    <li>
      <a href="../articles/espn_getendpoint.html">ESPN: Get Endpoint</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Cache</li>
    <li>
      <a href="../articles/ffscrapr_caching.html">Managing ffscrapr's Cache</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dynastyprocess/ffscrapr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="espn_getendpoint_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>ESPN: Get Endpoint</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dynastyprocess/ffscrapr/blob/master/vignettes/espn_getendpoint.Rmd"><code>vignettes/espn_getendpoint.Rmd</code></a></small>
      <div class="hidden name"><code>espn_getendpoint.Rmd</code></div>

    </div>

    
    
<div id="espn-api---an-adventure-into-uncharted-territory" class="section level2">
<h2 class="hasAnchor">
<a href="#espn-api---an-adventure-into-uncharted-territory" class="anchor"></a>ESPN API - An Adventure Into Uncharted Territory</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ffscrapr.dynastyprocess.com">ffscrapr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://httr.r-lib.org/">httr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://arxiv.org/abs/1403.2805">jsonlite</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidyverse/glue">glue</a></span><span class="op">)</span></code></pre></div>
<p>Accessing the ESPN Fantasy API is a bit of an adventure into an undocumented abyss. This vignette will give you a bit of a rundown on how to use <code>espn_getendpoint</code> and the lower-level <code>espn_getendpoint_raw</code>, talk about the <code>x-fantasy-filter</code>, and detail some of the known view parameters that could be helpful.</p>
</div>
<div id="known-endpoints" class="section level2">
<h2 class="hasAnchor">
<a href="#known-endpoints" class="anchor"></a>Known Endpoints</h2>
<p>The ESPN Fantasy API is typically accessed from two endpoints:</p>
<pre><code>https://fantasy.espn.com/apis/v3/games/ffl/seasons/{season}/segments/0/leagues/{league_id} # for 2018 onward
https://fantasy.espn.com/apis/v3/games/ffl/leagueHistory/{league_id}?seasonId={season} # for 2017 or earlier</code></pre>
<p>Here’s a non-exhaustive list of view endpoints that I know of:</p>
<ul>
<li>mTeam</li>
<li>mMatchup</li>
<li>mRoster</li>
<li>mSettings</li>
<li>mBoxscore</li>
<li>mMatchupScore</li>
<li>kona_player_info</li>
<li>player_wl</li>
<li>mSchedule</li>
<li>mScoreboard</li>
</ul>
<p>Please note that calling various combinations of these views at once can often return different results than calling them separately.</p>
<p>A good way to stumble on these endpoints is to load Developer Tools in your browser, go to the Network tab, and then interact with the fantasy.espn.com site to see what API requests the main page is making.</p>
<p>Alternatively, you can consult the source code of other API packages (including those in other languages) which might give you a bit of a better idea of what’s possible!</p>
</div>
<div id="using-espn_getendpoint" class="section level2">
<h2 class="hasAnchor">
<a href="#using-espn_getendpoint" class="anchor"></a>Using espn_getendpoint</h2>
<p>ESPN’s API is mostly structured as making requests of different views against the main league endpoint.</p>
<p>For example, <a href="https://fantasy.espn.com/apis/v3/games/ffl/seasons/2020/segments/0/leagues/899513?view=mDraftDetail">https://fantasy.espn.com/apis/v3/games/ffl/seasons/2020/segments/0/leagues/899513?view=mDraftDetail</a></p>
<p>will pull up draft details for the 2020 league ID 899513. <code>espn_getendpoint</code> helps facilitate this request by allowing you to instead write:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">conn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/espn_connect.html">espn_connect</a></span><span class="op">(</span>season <span class="op">=</span> <span class="fl">2020</span>, league_id <span class="op">=</span> <span class="fl">899513</span><span class="op">)</span>

<span class="va">draft_details</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/espn_getendpoint.html">espn_getendpoint</a></span><span class="op">(</span><span class="va">conn</span>, view <span class="op">=</span> <span class="st">"mDraftDetail"</span><span class="op">)</span>

<span class="va">draft_details</span>
<span class="co">#&gt; &lt;ESPN - GET https://fantasy.espn.com/apis/v3/games/ffl/seasons/2020/segments/0/leagues/899513?view=mDraftDetail&gt;</span>
<span class="co">#&gt; List of 8</span>
<span class="co">#&gt;  $ draftDetail    :List of 4</span>
<span class="co">#&gt;  $ gameId         : int 1</span>
<span class="co">#&gt;  $ id             : int 899513</span>
<span class="co">#&gt;  $ scoringPeriodId: int 18</span>
<span class="co">#&gt;  $ seasonId       : int 2020</span>
<span class="co">#&gt;  $ segmentId      : int 0</span>
<span class="co">#&gt;  $ settings       :List of 1</span>
<span class="co">#&gt;  $ status         :List of 21</span></code></pre></div>
<p>This will automatically pass in the league ID, season, and authentication cookies (if used) from the <code>conn</code> object and place it into the request.</p>
<p>You can also use the lower-level equivalent, <code>espn_getendpoint_raw</code>, which does not build the URL from the <code>conn</code> object but still uses the conn object to pass along any authentication cookies:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">draft_details_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/espn_getendpoint_raw.html">espn_getendpoint_raw</a></span><span class="op">(</span>
  <span class="va">conn</span>,
  <span class="st">"https://fantasy.espn.com/apis/v3/games/ffl/seasons/2020/segments/0/leagues/899513?view=mDraftDetail"</span><span class="op">)</span>

<span class="va">draft_details_raw</span>
<span class="co">#&gt; &lt;ESPN - GET https://fantasy.espn.com/apis/v3/games/ffl/seasons/2020/segments/0/leagues/899513?view=mDraftDetail&gt;</span>
<span class="co">#&gt; List of 8</span>
<span class="co">#&gt;  $ draftDetail    :List of 4</span>
<span class="co">#&gt;  $ gameId         : int 1</span>
<span class="co">#&gt;  $ id             : int 899513</span>
<span class="co">#&gt;  $ scoringPeriodId: int 18</span>
<span class="co">#&gt;  $ seasonId       : int 2020</span>
<span class="co">#&gt;  $ segmentId      : int 0</span>
<span class="co">#&gt;  $ settings       :List of 1</span>
<span class="co">#&gt;  $ status         :List of 21</span></code></pre></div>
<p>These are equivalent requests. One reason to use the “raw” version is to be able to pass multiple view parameters such as <code>view=mDraftDetail&amp;view=mSettings</code> as the query, which is not possible with the main endpoint function because it only accepts one option for the view http query.</p>
</div>
<div id="x-fantasy-filter" class="section level2">
<h2 class="hasAnchor">
<a href="#x-fantasy-filter" class="anchor"></a>X-Fantasy-Filter</h2>
<p>Many of the endpoints are also affected by a JSON header, <code>X-Fantasy-Filter</code>, which can filter/sort/limit (or remove limits) from the API response. Here is an example of how to build up a valid JSON x-fantasy-filter, sourced from the code for <code>ff_playerscores</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">xff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>players <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  limit <span class="op">=</span> <span class="fl">5</span>,
  sortPercOwned <span class="op">=</span> 
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>sortAsc <span class="op">=</span> <span class="cn">FALSE</span>,
         sortPriority <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
  filterStatsForTopScoringPeriodIDs <span class="op">=</span> 
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fl">2</span>,
         additionalValue <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"00"</span>, <span class="va">conn</span><span class="op">$</span><span class="va">season</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html">toJSON</a></span><span class="op">(</span>auto_unbox <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">xff</span>
<span class="co">#&gt; {"players":{"limit":5,"sortPercOwned":{"sortAsc":false,"sortPriority":1},"filterStatsForTopScoringPeriodIDs":{"value":2,"additionalValue":"002020"}}}</span></code></pre></div>
<p>This JSON limits the total responses to 5, filters the “statIDs” returned to just the ones prefixed by “00”, and sorts the whole thing by percent owned, descending.</p>
<p>I’m not exactly clear on what all of the options for x-fantasy-filter are, but you can use it to emulate what’s happening in the request on <code>fantasy.espn.com</code>.</p>
<p>Both the <code>espn_getendpoint</code> and <code>espn_getendpoint_raw</code> functions can accept x-fantasy-filters. <code>espn_getendpoint</code> has an <code>x_fantasy_filter</code>argument that takes the JSON object created above, while <code>espn_getendpoint_raw</code> requires that the object is converted into an HTTP header first.</p>
<p>Examples here:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">player_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/espn_getendpoint.html">espn_getendpoint</a></span><span class="op">(</span><span class="va">conn</span>, view <span class="op">=</span> <span class="st">"kona_player_info"</span>, x_fantasy_filter <span class="op">=</span> <span class="va">xff</span><span class="op">)</span>

<span class="va">player_scores_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/espn_getendpoint_raw.html">espn_getendpoint_raw</a></span><span class="op">(</span>
  <span class="va">conn</span>,
  <span class="st">"https://fantasy.espn.com/apis/v3/games/ffl/seasons/2020/segments/0/leagues/899513?view=kona_player_info"</span>,
  <span class="fu">httr</span><span class="fu">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/add_headers.html">add_headers</a></span><span class="op">(</span>`X-Fantasy-Filter` <span class="op">=</span> <span class="va">xff</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="other-espn-api-resources" class="section level2">
<h2 class="hasAnchor">
<a href="#other-espn-api-resources" class="anchor"></a>Other ESPN API resources</h2>
<p>Kiernan Nichols’s <a href="https://github.com/kiernann/fflr">fflr R package</a> is an R package available on CRAN that is built specifically for ESPN API access. As of this writing (2021-03-03) it only supports public leagues, and has a few style differences as a light-weight/lower-dependency package.</p>
<p>Many of the API endpoints are being researched in other languages and you might be able to draw inspiration on what’s possible by checking them out:</p>
<ul>
<li><p>Christian Wendt’s <a href="https://github.com/cwendt94/espn-api/">espn-api</a> Python package was incredibly helpful in discovering the known and documented API endpoints.</p></li>
<li><p>Mike Kreiser’s <a href="https://github.com/mkreiser/ESPN-Fantasy-Football-API">ESPN-Fantasy-Football-API</a> is a well-documented JS client.</p></li>
<li><p>Steven Morse also has several great <a href="https://stmorse.github.io/journal/espn-fantasy-v3.html">blog posts</a> on using the API, mostly accessed via Python.</p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://twitter.com/_TanHo">Tan Ho</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '7abddd2aa591d955b365235f35d75a38',
    indexName: 'dynastyprocess',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
