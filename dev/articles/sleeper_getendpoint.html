<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sleeper: Get Endpoint • ffscrapr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Sleeper: Get Endpoint">
<meta property="og:description" content="ffscrapr">
<meta property="og:image" content="ffscrapr.dynastyprocess.com/logo.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@_TanHo">
<meta name="twitter:site" content="@DynastyProcess">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ffscrapr</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">1.1.0.9003</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    <li class="dropdown-header">Getting Started</li>
    <li>
      <a href="../articles/mfl_basics.html">MFL: Basics</a>
    </li>
    <li>
      <a href="../articles/sleeper_basics.html">Sleeper: Basics</a>
    </li>
    <li>
      <a href="../articles/fleaflicker_basics.html">Fleaflicker: Basics</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Custom API Calls</li>
    <li>
      <a href="../articles/mfl_getendpoint.html">MFL: Get Endpoint</a>
    </li>
    <li>
      <a href="../articles/sleeper_getendpoint.html">Sleeper: Get Endpoint</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Cache</li>
    <li>
      <a href="../articles/ffscrapr_caching.html">Managing ffscrapr's Cache</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dynastyprocess/ffscrapr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="sleeper_getendpoint_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="sleeper_getendpoint_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="sleeper_getendpoint_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Sleeper: Get Endpoint</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dynastyprocess/ffscrapr/blob/master/vignettes/sleeper_getendpoint.Rmd"><code>vignettes/sleeper_getendpoint.Rmd</code></a></small>
      <div class="hidden name"><code>sleeper_getendpoint.Rmd</code></div>

    </div>

    
    
<div id="creating-custom-sleeper-api-calls" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-custom-sleeper-api-calls" class="anchor"></a>Creating custom Sleeper API calls</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ffscrapr.dynastyprocess.com">ffscrapr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org">purrr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidyverse/glue">glue</a></span><span class="op">)</span></code></pre></div>
<p>The <a href="https://docs.sleeper.app">Sleeper API is pretty extensive</a>. If there is something you’d like to access that’s beyond the current scope of ffscrapr, you can use the lower-level “<code>sleeper_getendpoint</code>” function to create a GET request and access the data, while still using the authentication and rate-limiting features I’ve already created.</p>
<p>Here is an example of how you can call one of the endpoints - in this case, let’s pull Sleeper’s trending players data!</p>
<p>We’ll start by opening up this page, <a href="https://docs.sleeper.app/#trending-players" class="uri">https://docs.sleeper.app/#trending-players</a>, which is the documentation page for this particular endpoint. From here, we can see that Sleeper’s documentation says the endpoint is:</p>
<p><code>https://api.sleeper.app/v1/players/&lt;sport&gt;/trending/&lt;type&gt;?lookback_hours=&lt;hours&gt;&amp;limit=&lt;int&gt;</code></p>
<p>On first glance, you can see that it takes two parameters within the endpoint call itself (<code>sport</code> and <code>type</code>) and we can further adjust the query with HTTP parameters <code>lookback_hours</code> and <code>limit</code>. The sleeper_getendpoint function already has the <code>https://api.sleeper.app/v1/</code> part encoded, so all we’ll need to do is pass in the remaining part of the URL as the endpoint, and pass the HTTP parameters in as arguments to the function (these are case sensitive!)</p>
<p>We can use the <code>glue</code> package to parameterise this, although you can also use base R’s paste function just as easily.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"add"</span>

<span class="va">query</span> <span class="op">&lt;-</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">'players/nfl/trending/{type}'</span><span class="op">)</span>

<span class="va">query</span>
<span class="co">#&gt; players/nfl/trending/add</span>

<span class="va">response_trending</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sleeper_getendpoint.html">sleeper_getendpoint</a></span><span class="op">(</span><span class="va">query</span>,lookback_hours <span class="op">=</span> <span class="fl">48</span>, limit <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">response_trending</span>, max.level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; List of 3</span>
<span class="co">#&gt;  $ content :List of 10</span>
<span class="co">#&gt;  $ query   : chr "https://api.sleeper.app/v1/players/nfl/trending/add?lookback_hours=48&amp;limit=10"</span>
<span class="co">#&gt;  $ response:List of 10</span>
<span class="co">#&gt;   ..- attr(*, "class")= chr "response"</span>
<span class="co">#&gt;  - attr(*, "class")= chr "sleeper_api"</span></code></pre></div>
<p>Along with the parsed content, the function also returns the query and the response that was sent by the server. These are helpful for debugging, but we can turn the content into a dataframe with some careful application of the tidyverse.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">df_trending</span> <span class="op">&lt;-</span> <span class="va">response_trending</span> <span class="op">%&gt;%</span> 
  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html">pluck</a></span><span class="op">(</span><span class="st">"content"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df_trending</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 2</span>
<span class="co">#&gt;   player_id  count</span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;int&gt;</span>
<span class="co">#&gt; 1 6918      394089</span>
<span class="co">#&gt; 2 4994      259116</span>
<span class="co">#&gt; 3 2306      255828</span>
<span class="co">#&gt; 4 2257      209828</span>
<span class="co">#&gt; 5 CLE       197243</span>
<span class="co">#&gt; 6 LAC       189749</span></code></pre></div>
<p>This isn’t very helpful without knowing who these players are, so let’s pull the players endpoint in as well - this one has a convenient function!</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">players</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sleeper_players.html">sleeper_players</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">player_id</span>, <span class="va">player_name</span>, <span class="va">pos</span>, <span class="va">team</span>, <span class="va">age</span><span class="op">)</span>

<span class="va">trending</span> <span class="op">&lt;-</span> <span class="va">df_trending</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">players</span>, by <span class="op">=</span> <span class="st">"player_id"</span><span class="op">)</span>

<span class="va">trending</span>
<span class="co">#&gt; # A tibble: 10 x 6</span>
<span class="co">#&gt;    player_id  count player_name     pos   team    age</span>
<span class="co">#&gt;    &lt;chr&gt;      &lt;int&gt; &lt;chr&gt;           &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 6918      394089 Salvon Ahmed    RB    MIA    21.9</span>
<span class="co">#&gt;  2 4994      259116 Kalen Ballage   RB    LAC    24.9</span>
<span class="co">#&gt;  3 2306      255828 Jameis Winston  QB    NO     26.9</span>
<span class="co">#&gt;  4 2257      209828 Carlos Hyde     RB    SEA    30.2</span>
<span class="co">#&gt;  5 CLE       197243 &lt;NA&gt;            DEF   CLE    NA  </span>
<span class="co">#&gt;  6 LAC       189749 &lt;NA&gt;            DEF   LAC    NA  </span>
<span class="co">#&gt;  7 6819      173425 Michael Pittman WR    IND    23.1</span>
<span class="co">#&gt;  8 3209      154198 Devontae Booker RB    LV     28.5</span>
<span class="co">#&gt;  9 MIN       145098 &lt;NA&gt;            DEF   MIN    NA  </span>
<span class="co">#&gt; 10 1387      134503 Rex Burkhead    RB    NE     30.4</span></code></pre></div>
<p>There - this means something to us now! As of this writing (2020-11-10), Kalen Ballage was the most added player. Haven’t we been bitten by this before?</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://twitter.com/_TanHo">Tan Ho</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
