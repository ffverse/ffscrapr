<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ffscrapr">
<title>Sleeper: Get Endpoint • ffscrapr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Sleeper: Get Endpoint">
<meta property="og:description" content="ffscrapr">
<meta property="og:image" content="https://ffscrapr.ffverse.com/reference/figures/logo.svg">
<meta property="og:image:alt" content="ffscrapr - an R package for Fantasy Football APIs">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@_TanHo">
<meta name="twitter:site" content="@DynastyProcess">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script async src="https://www.googletagmanager.com/gtag/js?id=G-LS05E6KG74"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-LS05E6KG74');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ffscrapr</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.4.7.00</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Getting Started</h6>
    <a class="dropdown-item" href="../articles/mfl_basics.html">MFL: Basics</a>
    <a class="dropdown-item" href="../articles/sleeper_basics.html">Sleeper: Basics</a>
    <a class="dropdown-item" href="../articles/fleaflicker_basics.html">Fleaflicker: Basics</a>
    <a class="dropdown-item" href="../articles/espn_basics.html">ESPN: Basics</a>
    <a class="dropdown-item" href="../articles/espn_authentication.html">ESPN: Private Leagues</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Custom API Calls</h6>
    <a class="dropdown-item" href="../articles/mfl_getendpoint.html">MFL: Get Endpoint</a>
    <a class="dropdown-item" href="../articles/sleeper_getendpoint.html">Sleeper: Get Endpoint</a>
    <a class="dropdown-item" href="../articles/fleaflicker_getendpoint.html">Fleaflicker: Get Endpoint</a>
    <a class="dropdown-item" href="../articles/espn_getendpoint.html">ESPN: Get Endpoint</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Cache</h6>
    <a class="dropdown-item" href="../articles/ffscrapr_caching.html">ffscrapr: Managing Cache</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://discord.com/invite/5Er2FBnnQa">
    <span class="fab fa fab fa-discord fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ffverse/ffscrapr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-more">More</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-more">
    <h6 class="dropdown-header" data-toc-skip>ffverse</h6>
    <a class="external-link dropdown-item" href="https://www.ffverse.com">ffverse.com</a>
    <a class="external-link dropdown-item" href="https://ffsimulator.ffverse.com">ffsimulator</a>
    <a class="external-link dropdown-item" href="https://ffpros.ffverse.com">ffpros</a>
    <a class="external-link dropdown-item" href="https://www.github.com/ffverse">ffverse GitHub</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>nflverse</h6>
    <a class="external-link dropdown-item" href="https://www.nflfastr.com">nflfastR package</a>
    <a class="external-link dropdown-item" href="https://github.com/nflverse">nflverse GitHub</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>DynastyProcess</h6>
    <a class="external-link dropdown-item" href="https://dynastyprocess.com">DynastyProcess.com</a>
    <a class="external-link dropdown-item" href="https://github.com/dynastyprocess">DynastyProcess GitHub</a>
  </div>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">
<script src="sleeper_getendpoint_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Sleeper: Get Endpoint</h1>
                        <h4 data-toc-skip class="author">Tan Ho</h4>
            
            <h4 data-toc-skip class="date">2021-12-24</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ffverse/ffscrapr/blob/HEAD/vignettes/sleeper_getendpoint.Rmd" class="external-link"><code>vignettes/sleeper_getendpoint.Rmd</code></a></small>
      <div class="d-none name"><code>sleeper_getendpoint.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="creating-custom-sleeper-api-calls">Creating custom Sleeper API calls<a class="anchor" aria-label="anchor" href="#creating-custom-sleeper-api-calls"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ffscrapr.ffverse.com">ffscrapr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="co">#&gt; Warning: package 'dplyr' was built under R version 4.2.0</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org" class="external-link">purrr</a></span><span class="op">)</span>
<span class="co">#&gt; Warning: package 'purrr' was built under R version 4.2.0</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidyverse/glue" class="external-link">glue</a></span><span class="op">)</span></code></pre></div>
<p>The <a href="https://docs.sleeper.app" class="external-link">Sleeper API is pretty extensive</a>. If there is something you’d like to access that’s beyond the current scope of ffscrapr, you can use the lower-level “<code>sleeper_getendpoint</code>” function to create a GET request and access the data, while still using the authentication and rate-limiting features I’ve already created.</p>
<p>Here is an example of how you can call one of the endpoints - in this case, let’s pull Sleeper’s trending players data!</p>
<p>We’ll start by opening up this page, <a href="https://docs.sleeper.app/#trending-players" class="external-link uri">https://docs.sleeper.app/#trending-players</a>, which is the documentation page for this particular endpoint. From here, we can see that Sleeper’s documentation says the endpoint is:</p>
<p><code>https://api.sleeper.app/v1/players/&lt;sport&gt;/trending/&lt;type&gt;?lookback_hours=&lt;hours&gt;&amp;limit=&lt;int&gt;</code></p>
<p>On first glance, you can see that it takes two parameters within the endpoint call itself (<code>sport</code> and <code>type</code>) and we can further adjust the query with HTTP parameters <code>lookback_hours</code> and <code>limit</code>. The sleeper_getendpoint function already has the <code>https://api.sleeper.app/v1/</code> part encoded, so all we’ll need to do is pass in the remaining part of the URL as the endpoint, and pass the HTTP parameters in as arguments to the function (these are case sensitive!)</p>
<p>We can use the <code>glue</code> package to parameterise this, although you can also use base R’s paste function just as easily.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"add"</span>

<span class="va">query</span> <span class="op">&lt;-</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">'players/nfl/trending/{type}'</span><span class="op">)</span>

<span class="va">query</span>
<span class="co">#&gt; players/nfl/trending/add</span>

<span class="va">response_trending</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sleeper_getendpoint.html">sleeper_getendpoint</a></span><span class="op">(</span><span class="va">query</span>,lookback_hours <span class="op">=</span> <span class="fl">48</span>, limit <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt; Using request.R from "ffscrapr"</span>
<span class="co">#&gt; No encoding supplied: defaulting to UTF-8.</span>

<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">response_trending</span>, max.level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; List of 3</span>
<span class="co">#&gt;  $ content :List of 10</span>
<span class="co">#&gt;  $ query   : chr "https://api.sleeper.app/v1/players/nfl/trending/add?lookback_hours=48&amp;limit=10"</span>
<span class="co">#&gt;  $ response:List of 8</span>
<span class="co">#&gt;   ..- attr(*, "class")= chr "response"</span>
<span class="co">#&gt;  - attr(*, "class")= chr "sleeper_api"</span></code></pre></div>
<p>Along with the parsed content, the function also returns the query and the response that was sent by the server. These are helpful for debugging, but we can turn the content into a dataframe with some careful application of the tidyverse.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">df_trending</span> <span class="op">&lt;-</span> <span class="va">response_trending</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html" class="external-link">pluck</a></span><span class="op">(</span><span class="st">"content"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df_trending</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 2</span></span>
<span class="co">#&gt;   player_id count</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 6002      <span style="text-decoration: underline;">14</span>287</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 7904      <span style="text-decoration: underline;">11</span>553</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 7703      <span style="text-decoration: underline;">11</span>403</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 4622       <span style="text-decoration: underline;">8</span>548</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2711       <span style="text-decoration: underline;">7</span>165</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 6271       <span style="text-decoration: underline;">5</span>452</span></code></pre></div>
<p>This isn’t very helpful without knowing who these players are, so let’s pull the players endpoint in as well - this one has a convenient function!</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">players</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sleeper_players.html">sleeper_players</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">player_id</span>, <span class="va">player_name</span>, <span class="va">pos</span>, <span class="va">team</span>, <span class="va">age</span><span class="op">)</span>
<span class="co">#&gt; No encoding supplied: defaulting to UTF-8.</span>

<span class="va">trending</span> <span class="op">&lt;-</span> <span class="va">df_trending</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">players</span>, by <span class="op">=</span> <span class="st">"player_id"</span><span class="op">)</span>

<span class="va">trending</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 6</span></span>
<span class="co">#&gt;    player_id count player_name       pos   team    age</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 6002      <span style="text-decoration: underline;">14</span>287 Qadree Ollison    RB    ATL    25.3</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 7904      <span style="text-decoration: underline;">11</span>553 Stevie Scott      RB    NO     <span style="color: #BB0000;">NA</span>  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 7703      <span style="text-decoration: underline;">11</span>403 Jacob Harris      TE    LAR    <span style="color: #BB0000;">NA</span>  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 4622       <span style="text-decoration: underline;">8</span>548 Keelan Cole       WR    NYJ    28.7</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2711       <span style="text-decoration: underline;">7</span>165 Taylor Heinicke   QB    WAS    28.8</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 6271       <span style="text-decoration: underline;">5</span>452 Olamide Zaccheaus WR    ATL    24.4</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 5199       <span style="text-decoration: underline;">4</span>462 Byron Pringle     WR    KC     28.1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 7622       <span style="text-decoration: underline;">4</span>082 Sammis Reyes      TE    WAS    26.2</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 7530       <span style="text-decoration: underline;">3</span>646 Frank Darby       WR    ATL    <span style="color: #BB0000;">NA</span>  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2583       <span style="text-decoration: underline;">3</span>201 Tyrell Williams   WR    DET    29.9</span></code></pre></div>
<p>There - this means something to us now! As of this writing (2020-11-10), Kalen Ballage was the most added player. Haven’t we been bitten by this before?</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://twitter.com/_TanHo" class="external-link">Tan Ho</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
